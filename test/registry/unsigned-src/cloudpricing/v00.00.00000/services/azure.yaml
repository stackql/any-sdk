openapi: 3.0.0
info:
  title: Azure Retail Prices - Pricing Service
  version: v00.00.00000
servers:
  - url: https://prices.azure.com/api/retail
    description: Azure Retail Prices API
    variables: {}
paths:
  /prices:
    get:
      operationId: prices_list
      summary: List Azure retail prices
      description: |
        Retrieves Azure retail prices with optional OData filtering.
        Supports filtering by serviceName, serviceFamily, armRegionName, skuName, priceType, and more.
      tags:
        - pricing
      parameters:
        - name: $filter
          in: query
          description: OData filter expression
          required: false
          schema:
            type: string
          examples:
            virtual_machines:
              value: "serviceName eq 'Virtual Machines'"
            compute_family:
              value: "serviceFamily eq 'Compute'"
            reservations:
              value: "priceType eq 'Reservation'"
            region_filtered:
              value: "armRegionName eq 'eastus'"
        - name: currencyCode
          in: query
          description: Currency code for prices (default USD)
          required: false
          schema:
            type: string
            default: USD
          examples:
            usd:
              value: USD
            eur:
              value: EUR
            aud:
              value: AUD
        - name: $skip
          in: query
          description: Number of records to skip for pagination
          required: false
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceListResponse'
components:
  schemas:
    PriceListResponse:
      type: object
      properties:
        BillingCurrency:
          type: string
        CustomerEntityId:
          type: string
        CustomerEntityType:
          type: string
        Items:
          type: array
          items:
            $ref: '#/components/schemas/PriceItem'
        NextPageLink:
          type: string
          nullable: true
        Count:
          type: integer
    PriceItem:
      type: object
      properties:
        currencyCode:
          type: string
          description: The currency in which rates are defined
        tierMinimumUnits:
          type: number
          description: Minimum units of consumption to avail the price
        reservationTerm:
          type: string
          nullable: true
          description: Reservation term - one year or three years
        retailPrice:
          type: number
          description: Microsoft Retail Prices without discount
        unitPrice:
          type: number
          description: Same as retailPrice
        armRegionName:
          type: string
          description: Azure Resource Manager region where the service is available
        location:
          type: string
          description: Azure data center where the resource is deployed
        effectiveStartDate:
          type: string
          format: date-time
          description: Date when the retail prices are effective
        meterId:
          type: string
          description: Unique identifier of the resource
        meterName:
          type: string
          description: Name of the meter
        productId:
          type: string
          description: UniqueID of the product
        skuId:
          type: string
          description: UniqueID for the SKU
        productName:
          type: string
          description: Product name
        skuName:
          type: string
          description: SKU name
        serviceName:
          type: string
          description: Name of the service
        serviceId:
          type: string
          description: UniqueID of the service
        serviceFamily:
          type: string
          description: Service family of the SKU
        unitOfMeasure:
          type: string
          description: How usage is measured for the service
        type:
          type: string
          description: Meter consumption type (DevTestConsumption, Reservation, Consumption)
        isPrimaryMeterRegion:
          type: boolean
          description: Indicates whether the meter region is set as a primary meter
        armSkuName:
          type: string
          description: SKU name registered in Azure
        term:
          type: string
          nullable: true
          description: Term length for Azure savings plan
  x-stackQL-resources:
    prices:
      id: cloudpricing.azure.prices
      name: prices
      title: Prices
      description: Azure retail prices for all services
      methods:
        list:
          operation:
            $ref: '#/paths/~1prices/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
            objectKey: $.Items[*]
      sqlVerbs:
        select:
          - $ref: '#/components/x-stackQL-resources/prices/methods/list'
        insert: []
        update: []
        replace: []
        delete: []
      config:
        queryParamPushdown:
          # Azure Retail Prices API only supports $filter with 'eq' operator
          # No support for $select, $orderby, $top, or $count
          filter:
            dialect: odata
            supportedOperators:
              - "eq"
            supportedColumns:
              - "armRegionName"
              - "location"
              - "meterId"
              - "meterName"
              - "productId"
              - "skuId"
              - "productName"
              - "skuName"
              - "serviceName"
              - "serviceId"
              - "serviceFamily"
              - "priceType"
              - "armSkuName"
        pagination:
          requestToken:
            key: "$skip"
            location: query
          responseToken:
            key: NextPageLink
            location: body
